Hereâ€™s a concise summary of the ProjectDiscovery analysis of CVEâ€‘2025â€‘29927: Next.js Middleware Authorization Bypass:

â¸»

ðŸ” Overview

A critical vulnerability (CVEâ€‘2025â€‘29927) was discovered in Next.js middlewareâ€”used for tasks like authentication, routing, and adding headers. It allows attackers to bypass any middleware-based controls (auth, CSP, redirects, etc.) simply by adding a crafted HTTP header: x-middleware-subrequest  .

â¸»

ðŸ§  How It Works

Internally, Next.js uses the x-middleware-subrequest header to detect and prevent recursive middleware calls. However, it was found that if an external request includes x-middleware-subrequest containing the middlewareâ€™s own identifier (e.g. "middleware" or "src/middleware"), Next.js skips middleware entirely via NextResponse.next()  .
	â€¢	Preâ€‘12.2: identifier looks like pages/_middleware or pages/dashboard/_middleware
	â€¢	12.2â€“13.x: becomes simply middleware or src/middleware
	â€¢	â‰¥â€¯13.2.0: depth checking requires five repetitions, e.g. middleware:middleware:middleware:middleware:middleware  

â¸»

âœ… Affected Versions

Next.js versions impacted include:
	â€¢	11.1.4 â†’ 13.5.6
	â€¢	14.x (before 14.2.25)
	â€¢	15.x (before 15.2.3)
Deployments on Vercel (and platforms like Netlify/Cloudflare) are automatically protected, but self-hosted apps must take action  .

â¸»

âš ï¸ Impact
	â€¢	Auth bypass: access protected routes (e.g., /dashboard/admin) without authentication
	â€¢	CSP bypass, enabling XSS or other header protections to be circumvented
	â€¢	Cache poisoning, where improper headers may allow unauthorized content injection  

â¸»

ðŸ›  Remediation
	1.	Upgrade to one of the patched Next.js versions:
	â€¢	14.2.25+, 15.2.3+, or suitable 13.x/12.x releases  
	2.	If immediate upgrading isnâ€™t possible, strip or block the x-middleware-subrequest header upstreamâ€”using load balancer rules (Cloudflare, AWS ELB), web servers (Nginx, Apache), or custom Express middleware  .

Example for Nginx:

proxy_set_header x-middleware-subrequest "";

Or in Express:

app.use((req, res, next) => {
  delete req.headers['x-middleware-subrequest'];
  next();
});


â¸»

ðŸ›¡ Detection

ProjectDiscovery released a Nuclei template to scan for eligible endpoints, detect middlewareâ€‘protected paths, and attempt bypass using crafted header payloads  .

â¸»

In Summary
	â€¢	What: CVEâ€‘2025â€‘29927 lets attackers bypass middleware by spoofing a Next.js internal header
	â€¢	Who: Affects Next.js 11.1.4â†’15.x (<14.2.25/15.2.3) â€” selfâ€‘hosted deployments are vulnerable
	â€¢	How: Add x-middleware-subrequest: [middleware identifier] to bypass
	â€¢	Fix: Upgrade or strip the header before it reaches your app

This vulnerability underscores why middleware shouldnâ€™t be trusted for critical auth logic unless the underlying framework is hardened against such header-based bypasses.

Let me know if youâ€™d like help applying the fix or running the Nuclei scan!